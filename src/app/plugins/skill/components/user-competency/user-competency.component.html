<div class="example-container table-container main-container">
  <p class="header flex custom mb-30">Competencies
    <mat-icon class="arrowRight">keyboard_arrow_right</mat-icon>
    User1
  </p>

  <div class="mb-30">
    <span class="flex custom userName">User Name</span>
    <span class="flex custom role">Role | Designation</span>
  </div>

  <div class="flex flex-between items-center pb-bb">
    <div class="flex items-center gap-4">
      <div class="flex items-center">
        <span>Competency</span>
      </div>
      <div class="flex items-center">
        <ng-container *ngFor="let legend of legends">
          <div class="legend-container">
            <div class="legend-color" [style.backgroundColor]="legend.color"> </div>
            <div class="legend-text">{{legend.name}}</div>
          </div>
        </ng-container>
      </div>
    </div>

    <div class="flex items-center gap-4">
      <button class="addBtn" type="submit" mat-raised-button (click)="openAddComperencyDialog()">Add new
        Competency</button>
    </div>
  </div>

  <!-- <div class="flex flex-between items-center">
    <ng-container *ngFor="let competencies of competenciesList">
      <div class="flex items-center w-full box boxPaddingText leftMostBox">
        <span>{{competencies.selectCompetency}}</span>
      </div>
      <div class="flex items-center">
        <ng-container *ngFor="let proficiency of competencies.proficiencyLevel">
          <ng-container *ngIf="proficiency.level.selected; else addLevel">
            <div class=" boxPaddingText box">
              <span>{{proficiency.level.level}}</span>
            </div>
          </ng-container>
          <ng-template #addLevel>
            <div class="boxPaddingIcon box ">
              <mat-icon class="addIcon">add_circle</mat-icon>
            </div>
          </ng-template>
        </ng-container>
        <div class="boxPaddingIcon box righMostBox">
          <mat-icon>keyboard_arrow_right</mat-icon>
        </div>
      </div>
    </ng-container>
  </div> -->

  <mat-accordion>
    <ng-container *ngFor="let competencies of competenciesList; let i = index">
      <mat-expansion-panel class="w-full panel" hideToggle (opened)="panelOpenState[i] = true"
        (closed)="panelOpenState[i] = false">
        <mat-expansion-panel-header class="flex flex-between items-center panel-header w-full"
          (click)="$event.preventDefault()">
          <mat-panel-title class="flex items-center w-full box boxPaddingText leftMostBox">
            <span>{{selectedCompetency(competencies.selectCompetency)}}</span>
          </mat-panel-title>
          <mat-panel-description class="flex items-center panel-header-description">
            <ng-container *ngFor="let proficiency of competencies.proficiencyLevel">
              <ng-container *ngIf="proficiency.level.selected; else addLevel">
                <div class="boxPaddingText box level requiredLevel">
                  <span>{{proficiency.level.level}}</span>
                </div>
              </ng-container>
              <ng-template #addLevel>
                <div class="boxPaddingIcon box requiredLevel">
                  <mat-icon (click)="isOpen = !isOpen" class="addIcon">add_circle</mat-icon>
                </div>
              </ng-template>
            </ng-container>
            <div class="boxPaddingIcon box righMostBox">
              <mat-icon [ngClass]="{'arrowReverse': panelOpenState[i] }">keyboard_arrow_down</mat-icon>
            </div>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <ng-container *ngIf="competencies.proficiencyLevel && competencies.proficiencyLevel.length > 0">
          <mat-table #table [dataSource]="dataSource" class="example-table table1 responsiveTable">
            <ng-container matColumnDef="{{col.key}}" *ngFor="let col of tableData">
              <mat-header-cell *matHeaderCellDef mat-sort-header class="h-400-r-14-l color-60"
                [ngClass]="{'level-flex' : col.key === 'level', 'source-flex': col.key === 'source'}">
                {{col.displayName}}
              </mat-header-cell>

              <mat-cell *matCellDef="let element"
                [ngClass]="{'level-flex' : col.key === 'level', 'source-flex': col.key === 'source'}">
                <span>{{element[col.key]}}</span>
              </mat-cell>
            </ng-container>

            <mat-header-row *matHeaderRowDef="getFinalColumns()"></mat-header-row>
            <mat-row *matRowDef="let row; columns: getFinalColumns();">
            </mat-row>
          </mat-table>
        </ng-container>

      </mat-expansion-panel>
    </ng-container>
  </mat-accordion>
</div>